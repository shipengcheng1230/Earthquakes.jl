



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Julia implementations of earthquake cycle simulation">
      
      
        <link rel="canonical" href="https://github.com/shipengcheng1230/Quaycle.jl/examples/generated/bp1/">
      
      
        <meta name="author" content="Pengcheng Shi">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-\.]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Example 1D - Quaycle.jl</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#03a9f4">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../assets/Documenter.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://github.com/shipengcheng1230/Quaycle.jl" title="Quaycle.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon">landscape</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Quaycle.jl
            </span>
            <span class="md-header-nav__topic">
              
                Example 1D
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/shipengcheng1230/Quaycle.jl/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Quaycle.jl
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://github.com/shipengcheng1230/Quaycle.jl" title="Quaycle.jl" class="md-nav__button md-logo">
      
        <i class="md-icon">landscape</i>
      
    </a>
    Quaycle.jl
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/shipengcheng1230/Quaycle.jl/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Quaycle.jl
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Quasi Dynamic Simulation using BEM
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Quasi Dynamic Simulation using BEM
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
    <a href="./" title="Example 1D" class="md-nav__link md-nav__link--active">
      Example 1D
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../otfsync/" title="Example 2D" class="md-nav__link">
      Example 2D
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Interface
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Interface
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interface_assemble/" title="Assemble" class="md-nav__link">
      Assemble
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interface_friction/" title="Friction" class="md-nav__link">
      Friction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interface_greensfun/" title="Greens Function" class="md-nav__link">
      Greens Function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interface_HDF5/" title="HDF5 Utility" class="md-nav__link">
      HDF5 Utility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interface_mesh/" title="Mesh" class="md-nav__link">
      Mesh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interface_property/" title="Simulation Property" class="md-nav__link">
      Simulation Property
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interface_rheology/" title="Rheology" class="md-nav__link">
      Rheology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interface_visualize/" title="Visualize" class="md-nav__link">
      Visualize
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../acknowledge/" title="Acknowledge" class="md-nav__link">
      Acknowledge
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/shipengcheng1230/Quaycle.jl/edit/master/docs/examples/generated/bp1.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Example 1D</h1>
                
                <div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example is from <a href="https://www.scec.org/publication/8214">Benchmark Problem 1</a> (hence referred as BP1).</p>
</div>
<p>First, we load the package</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">Quaycle</span>
<span class="k">using</span> <span class="n">Plots</span>
</pre></div>
</td></tr></table>

<p>The prerequisite parameters in this benchmark are list below:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">ms2mmyr</span> <span class="o">=</span> <span class="mi">365</span> <span class="o">*</span> <span class="mi">86400</span> <span class="o">*</span> <span class="mf">1e3</span> <span class="c"># convert velocity from m/s to mm/yr</span>
<span class="n">ρ</span> <span class="o">=</span> <span class="mf">2670.0</span> <span class="c"># density [kg/m³]</span>
<span class="n">vs</span> <span class="o">=</span> <span class="mf">3464.0</span> <span class="c"># shear wave velocity [m/s]</span>
<span class="n">σ0</span> <span class="o">=</span> <span class="mf">500.0</span> <span class="c"># effective normal stress [bar]</span>
<span class="n">a0</span> <span class="o">=</span> <span class="mf">0.010</span> <span class="c"># frictional paramter `a` in vw zone</span>
<span class="n">amax</span> <span class="o">=</span> <span class="mf">0.025</span> <span class="c"># frictional paramter `a` in vs zone</span>
<span class="n">b0</span> <span class="o">=</span> <span class="mf">0.015</span> <span class="c"># frictional paramter `b`</span>
<span class="n">L0</span> <span class="o">=</span> <span class="mf">8.0</span> <span class="c"># critical distance [mm]</span>
<span class="n">vpl</span> <span class="o">=</span> <span class="mf">1e-9</span> <span class="o">*</span> <span class="n">ms2mmyr</span> <span class="c"># plate rate [mm/yr]</span>
<span class="n">vinit</span> <span class="o">=</span> <span class="mf">1e-9</span> <span class="o">*</span> <span class="n">ms2mmyr</span> <span class="c"># initial velocity [mm/yr]</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">ms2mmyr</span> <span class="c"># reference velocity [mm/yr]</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="c"># reference frictional coefficient</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">15.0</span> <span class="c"># vw zone [km]</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="c"># vw-vs changing zone [km]</span>
<span class="n">Wf</span> <span class="o">=</span> <span class="mf">40.0</span> <span class="c"># fault depth [km]</span>
<span class="n">Δz</span> <span class="o">=</span> <span class="mf">100.0e-3</span> <span class="c"># grid size interval [km]</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mf">200.0</span><span class="p">;</span> <span class="nb">nothing</span> <span class="c"># simulation time [yr]</span>
</pre></div>
</td></tr></table>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure your units are consistent across the whole variable space.</p>
</div>
<p>Then we arrive at some parameters that are implicit by above:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">μ</span> <span class="o">=</span> <span class="n">vs</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ρ</span> <span class="o">/</span> <span class="mf">1e5</span> <span class="o">/</span> <span class="mf">1e6</span> <span class="c"># shear modulus [bar·km/mm]</span>
<span class="n">λ</span> <span class="o">=</span> <span class="n">μ</span> <span class="c"># poisson material</span>
<span class="n">η</span> <span class="o">=</span> <span class="n">μ</span> <span class="o">/</span> <span class="mi">2</span><span class="p">(</span><span class="n">vs</span> <span class="o">*</span> <span class="mf">1e-3</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">)</span>
<span class="n">ngrid</span> <span class="o">=</span> <span class="n">round</span><span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="n">Wf</span> <span class="o">/</span> <span class="n">Δz</span><span class="p">);</span> <span class="nb">nothing</span> <span class="c"># number of grids</span>
</pre></div>
</td></tr></table>

<p>First, set up a fault type which is strike-slip, and create a <strong>fault mesh</strong> by specifying depth and the desired discretization interval.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">ft</span> <span class="o">=</span> <span class="n">STRIKING</span><span class="p">()</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">gen_mesh</span><span class="p">(</span><span class="kt">Val</span><span class="p">(</span><span class="o">:</span><span class="n">LineOkada</span><span class="p">),</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">Δz</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">);</span> <span class="nb">nothing</span>
</pre></div>
</td></tr></table>

<p>Computing the Green's function for this setting.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">stress_greens_func</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">λ</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">ft</span><span class="p">);</span> <span class="nb">nothing</span>
</pre></div>
</td></tr></table>

<p>Then, provide the material properties w.r.t. our 'fault space'.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">.*</span> <span class="n">ones</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nξ</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="n">mesh</span><span class="o">.</span><span class="n">z</span> <span class="o">.≥</span> <span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">h</span><span class="p">)]</span> <span class="o">.=</span> <span class="n">amax</span>
<span class="n">a</span><span class="p">[</span><span class="n">H</span> <span class="o">.&lt;</span> <span class="o">-</span><span class="n">mesh</span><span class="o">.</span><span class="n">z</span> <span class="o">.&lt;</span> <span class="n">H</span> <span class="o">+</span> <span class="n">h</span><span class="p">]</span> <span class="o">.=</span> <span class="n">a0</span> <span class="o">.+</span> <span class="p">(</span><span class="n">amax</span> <span class="o">-</span> <span class="n">a0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">h</span> <span class="o">/</span> <span class="n">Δz</span><span class="p">)</span> <span class="o">*</span> <span class="n">collect</span><span class="p">(</span><span class="mi">1</span><span class="o">:</span> <span class="kt">Int</span><span class="p">(</span><span class="n">h</span> <span class="o">/</span> <span class="n">Δz</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">.*</span> <span class="n">ones</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nξ</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">L0</span> <span class="o">.*</span> <span class="n">ones</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nξ</span><span class="p">)</span>
<span class="n">σ</span> <span class="o">=</span> <span class="n">σ0</span> <span class="o">.*</span> <span class="n">ones</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nξ</span><span class="p">)</span>
<span class="n">prop</span> <span class="o">=</span> <span class="n">RateStateQuasiDynamicProperty</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="n">σ</span><span class="p">,</span> <span class="n">vpl</span><span class="o">=</span><span class="n">vpl</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="n">f0</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">η</span><span class="o">=</span><span class="n">η</span><span class="p">);</span> <span class="nb">nothing</span>
</pre></div>
</td></tr></table>

<p>Next, construct the initial condition and ODE problem using Okada's Green's function.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">τ0</span> <span class="o">=</span> <span class="n">σ0</span> <span class="o">*</span> <span class="n">amax</span> <span class="o">*</span> <span class="n">asinh</span><span class="p">(</span><span class="n">vinit</span> <span class="o">/</span> <span class="mi">2</span><span class="n">v0</span> <span class="o">*</span> <span class="n">exp</span><span class="p">((</span><span class="n">f0</span> <span class="o">+</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">v0</span> <span class="o">/</span> <span class="n">vinit</span><span class="p">))</span> <span class="o">/</span> <span class="n">amax</span><span class="p">))</span> <span class="o">+</span> <span class="n">η</span> <span class="o">*</span> <span class="n">vinit</span>
<span class="n">τz</span> <span class="o">=</span> <span class="n">fill</span><span class="p">(</span><span class="n">τ0</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
<span class="n">θz</span> <span class="o">=</span> <span class="err">@</span><span class="o">.</span> <span class="n">L</span> <span class="o">/</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="n">v0</span> <span class="o">/</span> <span class="n">vinit</span> <span class="o">*</span> <span class="n">sinh</span><span class="p">((</span><span class="n">τz</span> <span class="o">-</span> <span class="n">η</span> <span class="o">*</span> <span class="n">vinit</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span> <span class="o">/</span> <span class="n">σ</span><span class="p">))</span> <span class="o">-</span> <span class="n">f0</span> <span class="o">/</span> <span class="n">b0</span><span class="p">)</span>
<span class="n">vz</span> <span class="o">=</span> <span class="n">fill</span><span class="p">(</span><span class="n">vinit</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">ξ</span><span class="p">))</span>
<span class="n">u0</span> <span class="o">=</span> <span class="n">ArrayPartition</span><span class="p">(</span><span class="n">vz</span><span class="p">,</span> <span class="n">θz</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">assemble</span><span class="p">(</span><span class="n">gf</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span>  <span class="n">u0</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tf</span><span class="p">));</span> <span class="nb">nothing</span>
</pre></div>
</td></tr></table>

<p>Check our depth profile now.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">a</span> <span class="o">.-</span> <span class="n">b</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;a - b&quot;</span><span class="p">,</span> <span class="n">yflip</span><span class="o">=</span><span class="kc">true</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;Depth (km)&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip2100">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2100)" points="
0,1600 2400,1600 2400,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2101">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2100)" points="
230.483,1487.47 2352.76,1487.47 2352.76,47.2441 230.483,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2102">
    <rect x="230" y="47" width="2123" height="1441"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  557.5,47.2441 557.5,1487.47 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  957.929,47.2441 957.929,1487.47 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1358.36,47.2441 1358.36,1487.47 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1758.79,47.2441 1758.79,1487.47 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2159.22,47.2441 2159.22,1487.47 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  230.483,86.3027 2352.76,86.3027 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  230.483,426.831 2352.76,426.831 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  230.483,767.359 2352.76,767.359 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  230.483,1107.89 2352.76,1107.89 
  "/>
<polyline clip-path="url(#clip2102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  230.483,1448.42 2352.76,1448.42 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  230.483,1487.47 2352.76,1487.47 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  230.483,47.2441 230.483,1487.47 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  557.5,1487.47 557.5,1465.87 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  957.929,1487.47 957.929,1465.87 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1358.36,1487.47 1358.36,1465.87 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1758.79,1487.47 1758.79,1465.87 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2159.22,1487.47 2159.22,1465.87 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  230.483,86.3027 262.317,86.3027 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  230.483,426.831 262.317,426.831 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  230.483,767.359 262.317,767.359 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  230.483,1107.89 262.317,1107.89 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  230.483,1448.42 262.317,1448.42 
  "/>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 557.5, 1541.47)" x="557.5" y="1541.47">-0.003</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 957.929, 1541.47)" x="957.929" y="1541.47">0.000</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1358.36, 1541.47)" x="1358.36" y="1541.47">0.003</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1758.79, 1541.47)" x="1758.79" y="1541.47">0.006</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2159.22, 1541.47)" x="2159.22" y="1541.47">0.009</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 206.483, 103.803)" x="206.483" y="103.803">-40</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 206.483, 444.331)" x="206.483" y="444.331">-30</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 206.483, 784.859)" x="206.483" y="784.859">-20</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 206.483, 1125.39)" x="206.483" y="1125.39">-10</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 206.483, 1465.92)" x="206.483" y="1465.92">0</text>
</g>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;" transform="rotate(-90, 89.2861, 767.359)" x="89.2861" y="767.359">Depth (km)</text>
</g>
<polyline clip-path="url(#clip2102)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  290.547,1446.71 290.547,1443.31 290.547,1439.9 290.547,1436.5 290.547,1433.09 290.547,1429.69 290.547,1426.28 290.547,1422.88 290.547,1419.47 290.547,1416.07 
  290.547,1412.66 290.547,1409.26 290.547,1405.85 290.547,1402.44 290.547,1399.04 290.547,1395.63 290.547,1392.23 290.547,1388.82 290.547,1385.42 290.547,1382.01 
  290.547,1378.61 290.547,1375.2 290.547,1371.8 290.547,1368.39 290.547,1364.99 290.547,1361.58 290.547,1358.18 290.547,1354.77 290.547,1351.37 290.547,1347.96 
  290.547,1344.55 290.547,1341.15 290.547,1337.74 290.547,1334.34 290.547,1330.93 290.547,1327.53 290.547,1324.12 290.547,1320.72 290.547,1317.31 290.547,1313.91 
  290.547,1310.5 290.547,1307.1 290.547,1303.69 290.547,1300.29 290.547,1296.88 290.547,1293.48 290.547,1290.07 290.547,1286.67 290.547,1283.26 290.547,1279.85 
  290.547,1276.45 290.547,1273.04 290.547,1269.64 290.547,1266.23 290.547,1262.83 290.547,1259.42 290.547,1256.02 290.547,1252.61 290.547,1249.21 290.547,1245.8 
  290.547,1242.4 290.547,1238.99 290.547,1235.59 290.547,1232.18 290.547,1228.78 290.547,1225.37 290.547,1221.96 290.547,1218.56 290.547,1215.15 290.547,1211.75 
  290.547,1208.34 290.547,1204.94 290.547,1201.53 290.547,1198.13 290.547,1194.72 290.547,1191.32 290.547,1187.91 290.547,1184.51 290.547,1181.1 290.547,1177.7 
  290.547,1174.29 290.547,1170.89 290.547,1167.48 290.547,1164.07 290.547,1160.67 290.547,1157.26 290.547,1153.86 290.547,1150.45 290.547,1147.05 290.547,1143.64 
  290.547,1140.24 290.547,1136.83 290.547,1133.43 290.547,1130.02 290.547,1126.62 290.547,1123.21 290.547,1119.81 290.547,1116.4 290.547,1113 290.547,1109.59 
  290.547,1106.19 290.547,1102.78 290.547,1099.37 290.547,1095.97 290.547,1092.56 290.547,1089.16 290.547,1085.75 290.547,1082.35 290.547,1078.94 290.547,1075.54 
  290.547,1072.13 290.547,1068.73 290.547,1065.32 290.547,1061.92 290.547,1058.51 290.547,1055.11 290.547,1051.7 290.547,1048.3 290.547,1044.89 290.547,1041.48 
  290.547,1038.08 290.547,1034.67 290.547,1031.27 290.547,1027.86 290.547,1024.46 290.547,1021.05 290.547,1017.65 290.547,1014.24 290.547,1010.84 290.547,1007.43 
  290.547,1004.03 290.547,1000.62 290.547,997.216 290.547,993.811 290.547,990.405 290.547,987 290.547,983.595 290.547,980.19 290.547,976.784 290.547,973.379 
  290.547,969.974 290.547,966.568 290.547,963.163 290.547,959.758 290.547,956.353 290.547,952.947 290.547,949.542 290.547,946.137 290.547,942.732 290.547,939.326 
  357.285,935.921 424.024,932.516 490.762,929.11 557.5,925.705 624.238,922.3 690.976,918.895 757.714,915.489 824.452,912.084 891.191,908.679 957.929,905.273 
  1024.67,901.868 1091.41,898.463 1158.14,895.058 1224.88,891.652 1291.62,888.247 1358.36,884.842 1425.1,881.436 1491.83,878.031 1558.57,874.626 1625.31,871.221 
  1692.05,867.815 1758.79,864.41 1825.52,861.005 1892.26,857.599 1959,854.194 2025.74,850.789 2092.48,847.384 2159.22,843.978 2225.95,840.573 2292.69,837.168 
  2292.69,833.762 2292.69,830.357 2292.69,826.952 2292.69,823.547 2292.69,820.141 2292.69,816.736 2292.69,813.331 2292.69,809.925 2292.69,806.52 2292.69,803.115 
  2292.69,799.71 2292.69,796.304 2292.69,792.899 2292.69,789.494 2292.69,786.088 2292.69,782.683 2292.69,779.278 2292.69,775.873 2292.69,772.467 2292.69,769.062 
  2292.69,765.657 2292.69,762.251 2292.69,758.846 2292.69,755.441 2292.69,752.036 2292.69,748.63 2292.69,745.225 2292.69,741.82 2292.69,738.415 2292.69,735.009 
  2292.69,731.604 2292.69,728.199 2292.69,724.793 2292.69,721.388 2292.69,717.983 2292.69,714.578 2292.69,711.172 2292.69,707.767 2292.69,704.362 2292.69,700.956 
  2292.69,697.551 2292.69,694.146 2292.69,690.741 2292.69,687.335 2292.69,683.93 2292.69,680.525 2292.69,677.119 2292.69,673.714 2292.69,670.309 2292.69,666.904 
  2292.69,663.498 2292.69,660.093 2292.69,656.688 2292.69,653.282 2292.69,649.877 2292.69,646.472 2292.69,643.067 2292.69,639.661 2292.69,636.256 2292.69,632.851 
  2292.69,629.445 2292.69,626.04 2292.69,622.635 2292.69,619.23 2292.69,615.824 2292.69,612.419 2292.69,609.014 2292.69,605.608 2292.69,602.203 2292.69,598.798 
  2292.69,595.393 2292.69,591.987 2292.69,588.582 2292.69,585.177 2292.69,581.771 2292.69,578.366 2292.69,574.961 2292.69,571.556 2292.69,568.15 2292.69,564.745 
  2292.69,561.34 2292.69,557.934 2292.69,554.529 2292.69,551.124 2292.69,547.719 2292.69,544.313 2292.69,540.908 2292.69,537.503 2292.69,534.097 2292.69,530.692 
  2292.69,527.287 2292.69,523.882 2292.69,520.476 2292.69,517.071 2292.69,513.666 2292.69,510.261 2292.69,506.855 2292.69,503.45 2292.69,500.045 2292.69,496.639 
  2292.69,493.234 2292.69,489.829 2292.69,486.424 2292.69,483.018 2292.69,479.613 2292.69,476.208 2292.69,472.802 2292.69,469.397 2292.69,465.992 2292.69,462.587 
  2292.69,459.181 2292.69,455.776 2292.69,452.371 2292.69,448.965 2292.69,445.56 2292.69,442.155 2292.69,438.75 2292.69,435.344 2292.69,431.939 2292.69,428.534 
  2292.69,425.128 2292.69,421.723 2292.69,418.318 2292.69,414.913 2292.69,411.507 2292.69,408.102 2292.69,404.697 2292.69,401.291 2292.69,397.886 2292.69,394.481 
  2292.69,391.076 2292.69,387.67 2292.69,384.265 2292.69,380.86 2292.69,377.454 2292.69,374.049 2292.69,370.644 2292.69,367.239 2292.69,363.833 2292.69,360.428 
  2292.69,357.023 2292.69,353.617 2292.69,350.212 2292.69,346.807 2292.69,343.402 2292.69,339.996 2292.69,336.591 2292.69,333.186 2292.69,329.78 2292.69,326.375 
  2292.69,322.97 2292.69,319.565 2292.69,316.159 2292.69,312.754 2292.69,309.349 2292.69,305.943 2292.69,302.538 2292.69,299.133 2292.69,295.728 2292.69,292.322 
  2292.69,288.917 2292.69,285.512 2292.69,282.107 2292.69,278.701 2292.69,275.296 2292.69,271.891 2292.69,268.485 2292.69,265.08 2292.69,261.675 2292.69,258.27 
  2292.69,254.864 2292.69,251.459 2292.69,248.054 2292.69,244.648 2292.69,241.243 2292.69,237.838 2292.69,234.433 2292.69,231.027 2292.69,227.622 2292.69,224.217 
  2292.69,220.811 2292.69,217.406 2292.69,214.001 2292.69,210.596 2292.69,207.19 2292.69,203.785 2292.69,200.38 2292.69,196.974 2292.69,193.569 2292.69,190.164 
  2292.69,186.759 2292.69,183.353 2292.69,179.948 2292.69,176.543 2292.69,173.137 2292.69,169.732 2292.69,166.327 2292.69,162.922 2292.69,159.516 2292.69,156.111 
  2292.69,152.706 2292.69,149.3 2292.69,145.895 2292.69,142.49 2292.69,139.085 2292.69,135.679 2292.69,132.274 2292.69,128.869 2292.69,125.463 2292.69,122.058 
  2292.69,118.653 2292.69,115.248 2292.69,111.842 2292.69,108.437 2292.69,105.032 2292.69,101.626 2292.69,98.2212 2292.69,94.8159 2292.69,91.4106 2292.69,88.0053

<p>"/&gt;
<polygon clip-path="url(#clip2100)" points="
1932.36,251.724 2280.76,251.724 2280.76,130.764 1932.36,130.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip2100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1932.36,251.724 2280.76,251.724 2280.76,130.764 1932.36,130.764 1932.36,251.724 
  "/>
<polyline clip-path="url(#clip2100)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1956.36,191.244 2100.36,191.244 
  "/>
<g clip-path="url(#clip2100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2124.36, 208.744)" x="2124.36" y="208.744">a - b</text>
</g>
</svg></p>
<p>Afterwards, solve ODE thanks to <a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl">DifferentialEquations.jl</a></p>
<p>```@example bp1
sol = solve(prob, TsitPap8(), reltol=1e-6, abstol=1e-6); nothing
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>!!! tip
    Raise the accuracy option or switch to other algorithms if you get instability when solving these ODEs.



Finally, check the results. The first event happens at around 196 year:


```@example bp1
maxv = max_velocity(sol)
plot(sol.t, log10.(maxv / ms2mmyr), xlabel=&quot;Time (year)&quot;, ylabel=&quot;Max Velocity (log10 (m/s))&quot;, xlims=(190, 200), label=&quot;&quot;)
</pre></div>
</td></tr></table></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Click <a href="https://plot.ly/~shipengcheng/3/depth-km-vs-slip-m/">here</a> for the slip evolution over 3000 years simulation. It may need some time to load the page.</p>
</div>
<p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../.." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../otfsync/" title="Example 2D" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Example 2D
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 - 2019 <a href="https://github.com/shipengcheng1230/Quaycle.jl">Pengcheng Shi</a>
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/shipengcheng1230" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://www.linkedin.com/in/pengcheng-shi-396960148" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://steamcommunity.com/profiles/76561198054638928/" class="md-footer-social__link fa fa-steam"></a>
    
      <a href="https://live.xbox.com/en-US/Profile?Gamertag=ElyseesKukushka" class="md-footer-social__link fa fa-xbox"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../../assets/mathjaxhelper.js"></script>
      
    
  </body>
</html>